(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-876fcff4"],{2221:function(t,e,a){},"26cb":function(t,e,a){},"47cc":function(t,e,a){"use strict";var s=a("2221"),o=a.n(s);o.a},"6d14":function(t,e,a){"use strict";var s=a("26cb"),o=a.n(s);o.a},"80c1":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("common-layout",[s("div",{staticClass:"top"},[s("div",{staticClass:"header"},[s("img",{staticClass:"logo",attrs:{alt:"logo",src:a("4ffd")}}),s("span",{staticClass:"title"},[t._v(t._s(t.systemName))])]),s("div",{staticClass:"desc"},[t._v("简易版")])]),s("div",{staticClass:"login"},[s("a-form",{attrs:{form:t.form},on:{submit:t.onSubmit}},[s("a-tabs",{staticStyle:{padding:"0 2px"},attrs:{size:"large",tabBarStyle:{textAlign:"center"}}},[s("a-tab-pane",{key:"1",attrs:{tab:"账户密码登录"}},[t.error?s("a-alert",{staticStyle:{"margin-bottom":"24px"},attrs:{type:"error",closable:!0,message:t.error,showIcon:""},on:{close:t.onClose}}):t._e(),s("a-form-item",[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入账户名",whitespace:!0}]}],expression:"['name', {rules: [{ required: true, message: '请输入账户名', whitespace: true}]}]"}],attrs:{autocomplete:"autocomplete",size:"large",placeholder:"admin"}},[s("a-icon",{attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),s("a-form-item",[s("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"请输入密码",whitespace:!0}]}],expression:"['password', {rules: [{ required: true, message: '请输入密码', whitespace: true}]}]"}],attrs:{size:"large",placeholder:"888888",autocomplete:"autocomplete",type:"password"}},[s("a-icon",{attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1)],1)],1),s("div",[s("a-checkbox",{attrs:{checked:!0}},[t._v("自动登录")])],1),s("a-form-item",[s("a-button",{staticStyle:{width:"100%","margin-top":"24px"},attrs:{loading:t.logging,size:"large",htmlType:"submit",type:"primary"}},[t._v("登录")])],1)],1),s("div",{staticStyle:{display:"flex","justify-content":"center"}},[s("img",{staticClass:"gitee",attrs:{src:"https://cdn.jsdelivr.net/gh/2575829997/pic2//gitee2.svg",alt:"gitee登录"},on:{click:t.giteelogin}}),s("img",{staticClass:"weibo",attrs:{src:"https://cdn.jsdelivr.net/gh/2575829997/pic2//weibo.svg",alt:"微博登录"}}),s("img",{staticClass:"qq",attrs:{src:"https://cdn.jsdelivr.net/gh/2575829997/pic2//qq.svg",alt:"qq登录"}})])],1)])},o=[],i=a("5530"),r=(a("d81d"),a("d3b7"),a("25f0"),a("ac1f"),a("5319"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common-layout"},[a("div",{staticClass:"content"},[t._t("default")],2),a("page-footer",{attrs:{"link-list":t.footerLinks,copyright:t.copyright}})],1)}),n=[],c=a("613e"),l=a("5880"),d={name:"CommonLayout",components:{PageFooter:c["a"]},computed:Object(i["a"])({},Object(l["mapState"])("setting",["footerLinks","copyright"]))},u=d,m=(a("6d14"),a("0c7c")),p=Object(m["a"])(u,r,n,!1,null,"1c265f57",null),f=p.exports,g=a("93d6"),h=a("b775"),v=a("89a5"),b={name:"Login",components:{CommonLayout:f},data:function(){return{logging:!1,error:"",form:this.$form.createForm(this)}},computed:{systemName:function(){return this.$store.state.setting.systemName}},created:function(){var t=this,e=window.location.href,a=e.indexOf("code");if(-1!=a){var s=e.indexOf("#/login"),o=e.substring(a+5,s),i={code:o};null!=o&&Object(g["d"])(i).then((function(e){if(200==e.data.code){if(null==e.data.userinfo)return;var a=e.data.userinfo.username,s=e.data.userinfo.password;Object(g["h"])(a,s).then((function(e){t.afterLogin(e)})).catch((function(e){t.error=e.response.data.msg}))}}))}},methods:Object(i["a"])(Object(i["a"])({giteelogin:function(){var t="https://gitee.com/oauth/authorize?client_id=b86ce4941bdef22302a055dced706d7663fa6c5fd61d7579be32b46ae730c1e3&redirect_uri=https://www.xiaozhu.link/backstage/plus/index.html&response_type=code";window.open(t,"_self")}},Object(l["mapMutations"])("account",["setUser","setPermissions","setRoles","sethotellist"])),{},{onSubmit:function(t){var e=this;t.preventDefault(),this.form.validateFields((function(t){if(!t){e.logging=!0;var a=e.form.getFieldValue("name"),s=e.$md5(e.form.getFieldValue("password"));Object(g["h"])(a,s).then((function(t){e.afterLogin(t)})).catch((function(t){e.error=t.response.data.msg}))}}))},afterLogin:function(t){this.logging=!1;var e=t.data;if(200==e.code){this.setUser(t.data.user);var a=t.data.chotel,s=a.map((function(t){return t.hotelId}));a.map((function(t){t.hotelId=t.hotelId.toString()})),a.unshift({hotelCname:"*当前账号所有酒店*",hotelId:s.toString().replace("565","")}),this.sethotellist(a),Object(h["f"])({token:t.data.token,expireAt:30});var o=[];o.push(t.data.menu),Object(v["d"])(o),this.$router.push("/Statistics/orderStatistics"),this.$message.success(e.msg,3)}else this.error=e.msg},onClose:function(){this.error=!1}})},w=b,y=(a("47cc"),Object(m["a"])(w,s,o,!1,null,"7caa0a79",null)),x=y.exports;e["default"]=x}}]);